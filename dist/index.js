var A=Object.defineProperty;var E=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var v=(t,n,r)=>n in t?A(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,O=(t,n)=>{for(var r in n||(n={}))D.call(n,r)&&v(t,r,n[r]);if(E)for(var r of E(n))B.call(n,r)&&v(t,r,n[r]);return t};var T="/Users/PShryock/desktop/paul/jessica/perennial/packages",N="/Users/PShryock/desktop/paul/jessica/perennial",_="/Users/PShryock/desktop/paul/jessica/jessicawalch.com/jessica-walch-wp-theme",q="/Users/PShryock/desktop/paul/jessica/perennial/packages/content-api",U="iTerm.app",I="/usr/local/bin/node",j="/Users/PShryock/Desktop/paul/release-bump",L="xterm-256color",V="/bin/zsh",z="dist/cli.cjs",Z="https://registry.npmjs.org/",G="XQ9#6ngPyjG",H="/Users/PShryock/desktop/paul/jessica/jessicawalch.com",M="66.228.44.140",J="/var/folders/yl/55jg9h2s0qq84vy_hjj8djb40000gp/T/",Q="/usr/local",K="morbidly-bodacious-pulmonary",W="3.5.0beta5",X="/Users/PShryock/desktop/nba/watch-party/room-scheduling-server",Y="/Users/PShryock/desktop/nba/manage.nba.com/wordpress/wp-content/themes/manage-nba",ee="1",te="alpha",ne="w0t1p0:DEF32510-5469-4DDC-9F7F-387E758A1432",re="",ie="/Users/PShryock/desktop/paul/jessica",se="/Users/PShryock/Desktop/paul/release-bump",oe="user:15451034:634",ae="/Users/PShryock/.oh-my-zsh",le="3.0.0-alpha.32",ce="/Users/PShryock/desktop/nba",pe="PShryock",ge="/Users/PShryock/desktop/paul/paul-shryock/realogy",de="/Users/PShryock/desktop/paul/jessica/perennial/packages/cms/plugins",ue="unix2003",fe="3.0.0-alpha.31",me="/usr/local/etc/npmrc",he="/Users/PShryock/desktop/paul/jessica/jessicawalch.com/jessica-walch-wp-plugin",ye="/Users/PShryock/desktop/nba/wordpress.nba.com/wordpress/wp-content/themes",be="/Users/PShryock/.kube/config:/Users/PShryock/.kube/nba-com-dev",xe="/Users/PShryock/desktop/nba/manage.nba.com/plugins-mgr",$e="/Users/PShryock/desktop/nba/wordpress.nba.com/wordpress",Oe="paulshryock",Pe="/private/tmp/com.apple.launchd.lUOKteYJzJ/Listeners",Re="120",we="0x1F6:0x0:0x0",Ee="/usr/local/lib/node_modules/npm/bin/npm-cli.js",ve="/Users/PShryock/desktop/nba/manage.nba.com/plugins-mgr/plugins",Fe="/Users/PShryock/desktop/paul",ke="less",Se="6cba6cbf5b26deff0296f2c09acd6b6dded51065",Ce="/Users/PShryock/desktop/paul/paul-shryock",Ae="Gxfxcxdxbxegedabagacad",De="10.103.132.17",Be="/Applications/iTerm.app/Contents/Resources/terminfo:/usr/share/terminfo",Te="/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin:/Users/PShryock/Desktop/paul/node_modules/.bin:/Users/PShryock/Desktop/node_modules/.bin:/Users/PShryock/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin:/Users/PShryock/Desktop/paul/node_modules/.bin:/Users/PShryock/Desktop/node_modules/.bin:/Users/PShryock/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin:/Users/PShryock/Desktop/paul/node_modules/.bin:/Users/PShryock/Desktop/node_modules/.bin:/Users/PShryock/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/MacGPG2/bin:/Users/PShryock/.cargo/bin:/usr/local/opt/php/bin:/usr/local/opt/php/sbin:/Users/PShryock/.composer/vendor/bin",Ne="/Users/PShryock/desktop/nba/manage.nba.com/wordpress/wp-content/themes",_e="springsh",qe="/Users/PShryock/Desktop/paul/release-bump/package.json",Ue="true",Ie="/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin/ts-node",je="/Users/PShryock/desktop/nba/watch-party",Le="/Users/PShryock/.npmrc",Ve="/Users/PShryock/.npm-init.js",ze="com.googlecode.iterm2",Ze="run-script",Ge="Tc84#%5V*Z#",He="9sCa7eGPv6S*&PFc;",Me="/Users/PShryock/desktop/paul/release-bump",Je="compile:source",Qe="vi",Ke="release-bump",We="en_US.UTF-8",Xe="/Users/PShryock/desktop/nba/wordpress.nba.com/wordpress/wp-content/plugins",Ye="Default",et="120",tt="/Users/PShryock/desktop/nba/watch-party/nba-watch-party-client",nt="/Users/PShryock/desktop/paul/jessica/perennial/packages/cms/themes",rt="paulshryock",it="0x0",st=">=17.5.0",ot="/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",at="f780ecc1988ce88fd1bdcdecc32858c5b66e64bdc349db6612f6c44ef81ac303",lt="3.0.0-alpha.32",ct="0",pt="4",gt="/Users/PShryock",dt="15;0",ut="/Users/PShryock/desktop/paul/jessica/perennial/packages/cms",ft="3.5.0beta5",mt="true",ht="162.253.224.19",yt="w0t1p0:DEF32510-5469-4DDC-9F7F-387E758A1432",bt="/Users/PShryock/.npm",xt="-R",$t="PShryock",Ot="ts-node ./bin/compile.ts",Pt="10.103.132.111",Rt="0",wt="npm/8.5.5 node/v17.8.0 darwin x64 workspaces/false",Et="/Users/PShryock/desktop/nba/wordpress.nba.com",vt="/Users/PShryock/desktop/paul/jessica/jessicawalch.com/jessica-walch-2021",Ft="/Users/PShryock/desktop/nba/manage.nba.com",kt="iTerm2",St="/Users/PShryock/desktop/paul/jessica/perennial/packages/www",Ct="Paul Shryock",At="/usr/local/bin/node",Dt="/usr/local",Bt="truecolor",Tt="3.0.0-alpha.32",f={PERENNIAL_PACKAGES_DIR:T,PERENNIAL_DIR:N,JESSICA_THEME_DIR:_,PERENNIAL_CAPI_DIR:q,TERM_PROGRAM:U,NODE:I,INIT_CWD:j,TERM:L,SHELL:V,"npm_package_bin_release-bump":z,npm_config_metrics_registry:Z,AFFILIATES_PW_DEV:G,JESSICA_WALCH_COM_DIR:H,PAUL_LINODE_SSH_IP_ADDRESS:M,TMPDIR:J,npm_config_global_prefix:Q,PAUL_LINODE_SSH_PASSWORD:K,TERM_PROGRAM_VERSION:W,WATCHPARTY_SERVER_DIR:X,MANAGE_NBA_THEME_DIR:Y,COLOR:ee,npm_config_preid:te,TERM_SESSION_ID:ne,npm_config_noproxy:re,JESSICA_DIR:ie,npm_config_local_prefix:se,AMO_JWT_ISSUER:oe,ZSH:ae,npm_new_version:le,NBA_DIR:ce,USER:pe,REALOGY_DIR:ge,PERENNIAL_CMS_PLUGINS_DIR:de,COMMAND_MODE:ue,npm_old_version:fe,npm_config_globalconfig:me,JESSICA_PLUGIN_DIR:he,AFFILIATES_THEMES_DIR:ye,KUBECONFIG:be,MANAGE_NBA_PLUGIN_MANAGER_DIR:xe,AFFILIATES_WP_DIR:$e,PAUL_LINODE_SSH_USERNAME:Oe,SSH_AUTH_SOCK:Pe,COMPOSE_HTTP_TIMEOUT:Re,__CF_USER_TEXT_ENCODING:we,npm_execpath:Ee,MANAGE_NBA_PLUGINS_DIR:ve,PAUL_ROOT_DIR:Fe,PAGER:ke,PAUL_GITHUB_TOKEN:Se,PAUL_DIR:Ce,LSCOLORS:Ae,AFFILIATES_IP_DEV:De,TERMINFO_DIRS:Be,PATH:Te,MANAGE_NBA_THEMES_DIR:Ne,PAUL_X10_SSH_USERNAME:_e,npm_package_json:qe,npm_config_engine_strict:Ue,_:Ie,WATCHPARTY_DIR:je,npm_config_userconfig:Le,npm_config_init_module:Ve,__CFBundleIdentifier:ze,npm_command:Ze,AFFILIATES_PW_QA:Ge,PAUL_X10_SSH_PASSWORD:He,PWD:Me,npm_lifecycle_event:Je,EDITOR:Qe,npm_package_name:Ke,LANG:We,AFFILIATES_PLUGINS_DIR:Xe,ITERM_PROFILE:Ye,DOCKER_CLIENT_TIMEOUT:et,WATCHPARTY_CLIENT_DIR:tt,PERENNIAL_CMS_THEMES_DIR:nt,PAUL_GITHUB_USERNAME:rt,XPC_FLAGS:it,npm_package_engines_node:st,npm_config_node_gyp:ot,AMO_JWT_SECRET:at,npm_package_version:lt,XPC_SERVICE_NAME:ct,SHLVL:pt,HOME:gt,COLORFGBG:dt,PERENNIAL_CMS_DIR:ut,LC_TERMINAL_VERSION:ft,npm_config_save_exact:mt,PAUL_X10_SSH_IP_ADDRESS:ht,ITERM_SESSION_ID:yt,npm_config_cache:bt,LESS:xt,LOGNAME:$t,npm_lifecycle_script:Ot,AFFILIATES_IP_QA:Pt,N_PRESERVE_NPM:Rt,npm_config_user_agent:wt,AFFILIATES_DIR:Et,JESSICA_FRONT_END_DIR:vt,MANAGE_NBA_DIR:Ft,LC_TERMINAL:kt,PERENNIAL_WWW_DIR:St,npm_config_init_author_name:Ct,npm_node_execpath:At,npm_config_prefix:Dt,COLORTERM:Bt,RELEASE_BUMP_VERSION:Tt};import{readFileSync as Nt}from"fs";import{readdir as _t,stat as qt}from"fs/promises";import{join as Ut}from"path";function F(t,n){return t.filter(r=>!n.some(s=>r.includes(s)))}function k(t){if(typeof t=="string"){if(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()!@:%_+.~#?&/=]*)/.test(t))return t;if(/^[-a-zA-Z0-9()!@:%_+~#?&=]+\/[-a-zA-Z0-9()!@:%_+~#?&=]+$/.test(t))return`https://github.com/${t}`}else return typeof(t==null?void 0:t.url)>"u"?"":k(t.url.replace(/(^git\+|\.git$)/,""));return""}async function S(t,n){var y,g;let{date:r,isChangelog:s,prefix:o,quiet:a,release:l,repository:i}=n;if(!/^\d+\.\d+\.\d+$/.test(l))return t;let c=(g=(y=/\d+\.\d+\.\d+/.exec(l))==null?void 0:y[0])!=null?g:l;if(s===!1)return t.replace(/@([Ss]ince|[Vv]ersion)(:?\s+)unreleased/g,`@$1$2${c}`);let m=i.includes("bitbucket.org")?"bitbucket":"github",h=`${i}/${m==="bitbucket"?"commits":"releases"}/tag/${o?"v":""}${c}`,p=`## [${o?"v":""}${c}]`+(i!==""?`(${h})`:"")+(r?` - ${r}`:"");if(t.includes(p))return a!==!0&&console.info("changelog is already formatted"),t;let R=`(${i}/${m==="bitbucket"?"branches/":""}compare/HEAD..${o?"v":""}${c})`,b=`## [Unreleased]${i?R:""}

### `+["Added","Changed","Deprecated","Removed","Fixed","Security"].join(`

### `);return t.replace(/## \[Unreleased\](\(.*\))?/,p).replace(/### (Added|Changed|Deprecated|Removed|Fixed|Security)\n\n/g,"").replace(/### (Added|Changed|Deprecated|Removed|Fixed|Security)\n$/g,"").replace(/\n\n$/g,`
`).replace(p,b+`

`+p)}async function P(t){let{directoriesToIgnore:n,failOnError:r,filesPath:s,paths:o}=t;if(n.some(i=>s.includes(i)))return o!=null?o:[];let a=[];try{a=await _t(s)}catch(i){if(i.code!=="ENOENT"){if(r)throw process.exitCode=1,i;console.warn(`could not read files in ${s}`)}a=[]}let l=await Promise.all(a.map(async i=>(await qt(`${s}/${i}`)).isDirectory()===!0?await P({directoriesToIgnore:n,failOnError:r,filesPath:`${s}/${i}`,paths:o}):Ut(`${s}/${i}`)));return[...new Set([...o,...l].flat(100))]}function C(t){var a;let n={repository:"",version:"0.0.0"};try{n=JSON.parse(Nt("package.json","utf8"))}catch(l){f.NODE_ENV!=="test"&&t.quiet!==!0&&console.warn("could not read package.json")}let r=[".git",".github","coverage","dist","node_modules","tests/fixtures"],s={changelogPath:"CHANGELOG.md",date:(a=new Date().toISOString().split("T"))==null?void 0:a[0],dryRun:!1,failOnError:!1,filesPath:".",ignore:r,prefix:!1,quiet:f.NODE_ENV==="test"||!1,release:n.version,repository:k(n.repository)};return O(O({},s),t)}import{readFile as It,writeFile as jt}from"fs/promises";async function Wt(t){let{changelogPath:n,date:r,dryRun:s,failOnError:o,filesPath:a,ignore:l,prefix:i,quiet:d,release:c,repository:m}=C(t),h=f.NODE_ENV==="test"||s===!0,p=l,b=await P({directoriesToIgnore:p,failOnError:o,filesPath:a,paths:[n]}),y=F(b,p),g=[];return await Promise.all(y.map(async u=>{let x="";try{x=await It(u,"utf8")}catch($){if(o)throw process.exitCode=1,$;d!==!0&&console.warn(`could not read ${u}`)}let w=await S(x,{date:r,isChangelog:n===u,prefix:i,quiet:d,release:c,repository:m});if(x!==w&&(g.push(u),h!==!0))try{await jt(u,w,"utf8")}catch($){if(o)throw process.exitCode=1,$;d!==!0&&console.warn(`could not write ${u}`)}})),g.length>0&&d!==!0&&console.info((h?"would have ":"")+`bumped ${g.join(", ")}`),s?[]:g}export{Wt as releaseBump};
