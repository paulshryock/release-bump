#!/usr/bin/env node
var z=Object.defineProperty;var x=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var A=(t,i,r)=>i in t?z(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r,m=(t,i)=>{for(var r in i||(i={}))S.call(i,r)&&A(t,r,i[r]);if(x)for(var r of x(i))C.call(i,r)&&A(t,r,i[r]);return t};var T=(t,i)=>{var r={};for(var n in t)S.call(t,n)&&i.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&x)for(var n of x(t))i.indexOf(n)<0&&C.call(t,n)&&(r[n]=t[n]);return r};var Z="/Users/PShryock/desktop/paul/jessica/perennial/packages",G="/Users/PShryock/desktop/paul/jessica/perennial",H="/Users/PShryock/desktop/paul/jessica/jessicawalch.com/jessica-walch-wp-theme",M="/Users/PShryock/desktop/paul/jessica/perennial/packages/content-api",J="iTerm.app",Q="/usr/local/bin/node",K="/Users/PShryock/Desktop/paul/release-bump",W="xterm-256color",X="/bin/zsh",Y="dist/cli.cjs",ee="https://registry.npmjs.org/",te="XQ9#6ngPyjG",re="/Users/PShryock/desktop/paul/jessica/jessicawalch.com",ne="66.228.44.140",ie="/var/folders/yl/55jg9h2s0qq84vy_hjj8djb40000gp/T/",se="/usr/local",oe="morbidly-bodacious-pulmonary",ae="3.5.0beta5",le="/Users/PShryock/desktop/nba/watch-party/room-scheduling-server",ce="/Users/PShryock/desktop/nba/manage.nba.com/wordpress/wp-content/themes/manage-nba",pe="1",ge="alpha",ue="w0t1p0:DEF32510-5469-4DDC-9F7F-387E758A1432",de="",fe="/Users/PShryock/desktop/paul/jessica",me="/Users/PShryock/Desktop/paul/release-bump",he="user:15451034:634",ye="/Users/PShryock/.oh-my-zsh",be="3.0.0-alpha.32",xe="/Users/PShryock/desktop/nba",$e="PShryock",Oe="/Users/PShryock/desktop/paul/paul-shryock/realogy",Pe="/Users/PShryock/desktop/paul/jessica/perennial/packages/cms/plugins",Re="unix2003",we="3.0.0-alpha.31",Ee="/usr/local/etc/npmrc",ve="/Users/PShryock/desktop/paul/jessica/jessicawalch.com/jessica-walch-wp-plugin",Fe="/Users/PShryock/desktop/nba/wordpress.nba.com/wordpress/wp-content/themes",ke="/Users/PShryock/.kube/config:/Users/PShryock/.kube/nba-com-dev",Ae="/Users/PShryock/desktop/nba/manage.nba.com/plugins-mgr",Se="/Users/PShryock/desktop/nba/wordpress.nba.com/wordpress",Ce="paulshryock",Te="/private/tmp/com.apple.launchd.lUOKteYJzJ/Listeners",Be="120",De="0x1F6:0x0:0x0",Ne="/usr/local/lib/node_modules/npm/bin/npm-cli.js",_e="/Users/PShryock/desktop/nba/manage.nba.com/plugins-mgr/plugins",qe="/Users/PShryock/desktop/paul",Ue="less",Ie="6cba6cbf5b26deff0296f2c09acd6b6dded51065",Ve="/Users/PShryock/desktop/paul/paul-shryock",je="Gxfxcxdxbxegedabagacad",Le="10.103.132.17",ze="/Applications/iTerm.app/Contents/Resources/terminfo:/usr/share/terminfo",Ze="/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin:/Users/PShryock/Desktop/paul/node_modules/.bin:/Users/PShryock/Desktop/node_modules/.bin:/Users/PShryock/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin:/Users/PShryock/Desktop/paul/node_modules/.bin:/Users/PShryock/Desktop/node_modules/.bin:/Users/PShryock/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin:/Users/PShryock/Desktop/paul/node_modules/.bin:/Users/PShryock/Desktop/node_modules/.bin:/Users/PShryock/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/MacGPG2/bin:/Users/PShryock/.cargo/bin:/usr/local/opt/php/bin:/usr/local/opt/php/sbin:/Users/PShryock/.composer/vendor/bin",Ge="/Users/PShryock/desktop/nba/manage.nba.com/wordpress/wp-content/themes",He="springsh",Me="/Users/PShryock/Desktop/paul/release-bump/package.json",Je="true",Qe="/Users/PShryock/Desktop/paul/release-bump/node_modules/.bin/ts-node",Ke="/Users/PShryock/desktop/nba/watch-party",We="/Users/PShryock/.npmrc",Xe="/Users/PShryock/.npm-init.js",Ye="com.googlecode.iterm2",et="run-script",tt="Tc84#%5V*Z#",rt="9sCa7eGPv6S*&PFc;",nt="/Users/PShryock/desktop/paul/release-bump",it="compile:source",st="vi",ot="release-bump",at="en_US.UTF-8",lt="/Users/PShryock/desktop/nba/wordpress.nba.com/wordpress/wp-content/plugins",ct="Default",pt="120",gt="/Users/PShryock/desktop/nba/watch-party/nba-watch-party-client",ut="/Users/PShryock/desktop/paul/jessica/perennial/packages/cms/themes",dt="paulshryock",ft="0x0",mt=">=17.5.0",ht="/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",yt="f780ecc1988ce88fd1bdcdecc32858c5b66e64bdc349db6612f6c44ef81ac303",bt="3.0.0-alpha.32",xt="0",$t="4",Ot="/Users/PShryock",Pt="15;0",Rt="/Users/PShryock/desktop/paul/jessica/perennial/packages/cms",wt="3.5.0beta5",Et="true",vt="162.253.224.19",Ft="w0t1p0:DEF32510-5469-4DDC-9F7F-387E758A1432",kt="/Users/PShryock/.npm",At="-R",St="PShryock",Ct="ts-node ./bin/compile.ts",Tt="10.103.132.111",Bt="0",Dt="npm/8.5.5 node/v17.8.0 darwin x64 workspaces/false",Nt="/Users/PShryock/desktop/nba/wordpress.nba.com",_t="/Users/PShryock/desktop/paul/jessica/jessicawalch.com/jessica-walch-2021",qt="/Users/PShryock/desktop/nba/manage.nba.com",Ut="iTerm2",It="/Users/PShryock/desktop/paul/jessica/perennial/packages/www",Vt="Paul Shryock",jt="/usr/local/bin/node",Lt="/usr/local",zt="truecolor",Zt="3.0.0-alpha.32",d={PERENNIAL_PACKAGES_DIR:Z,PERENNIAL_DIR:G,JESSICA_THEME_DIR:H,PERENNIAL_CAPI_DIR:M,TERM_PROGRAM:J,NODE:Q,INIT_CWD:K,TERM:W,SHELL:X,"npm_package_bin_release-bump":Y,npm_config_metrics_registry:ee,AFFILIATES_PW_DEV:te,JESSICA_WALCH_COM_DIR:re,PAUL_LINODE_SSH_IP_ADDRESS:ne,TMPDIR:ie,npm_config_global_prefix:se,PAUL_LINODE_SSH_PASSWORD:oe,TERM_PROGRAM_VERSION:ae,WATCHPARTY_SERVER_DIR:le,MANAGE_NBA_THEME_DIR:ce,COLOR:pe,npm_config_preid:ge,TERM_SESSION_ID:ue,npm_config_noproxy:de,JESSICA_DIR:fe,npm_config_local_prefix:me,AMO_JWT_ISSUER:he,ZSH:ye,npm_new_version:be,NBA_DIR:xe,USER:$e,REALOGY_DIR:Oe,PERENNIAL_CMS_PLUGINS_DIR:Pe,COMMAND_MODE:Re,npm_old_version:we,npm_config_globalconfig:Ee,JESSICA_PLUGIN_DIR:ve,AFFILIATES_THEMES_DIR:Fe,KUBECONFIG:ke,MANAGE_NBA_PLUGIN_MANAGER_DIR:Ae,AFFILIATES_WP_DIR:Se,PAUL_LINODE_SSH_USERNAME:Ce,SSH_AUTH_SOCK:Te,COMPOSE_HTTP_TIMEOUT:Be,__CF_USER_TEXT_ENCODING:De,npm_execpath:Ne,MANAGE_NBA_PLUGINS_DIR:_e,PAUL_ROOT_DIR:qe,PAGER:Ue,PAUL_GITHUB_TOKEN:Ie,PAUL_DIR:Ve,LSCOLORS:je,AFFILIATES_IP_DEV:Le,TERMINFO_DIRS:ze,PATH:Ze,MANAGE_NBA_THEMES_DIR:Ge,PAUL_X10_SSH_USERNAME:He,npm_package_json:Me,npm_config_engine_strict:Je,_:Qe,WATCHPARTY_DIR:Ke,npm_config_userconfig:We,npm_config_init_module:Xe,__CFBundleIdentifier:Ye,npm_command:et,AFFILIATES_PW_QA:tt,PAUL_X10_SSH_PASSWORD:rt,PWD:nt,npm_lifecycle_event:it,EDITOR:st,npm_package_name:ot,LANG:at,AFFILIATES_PLUGINS_DIR:lt,ITERM_PROFILE:ct,DOCKER_CLIENT_TIMEOUT:pt,WATCHPARTY_CLIENT_DIR:gt,PERENNIAL_CMS_THEMES_DIR:ut,PAUL_GITHUB_USERNAME:dt,XPC_FLAGS:ft,npm_package_engines_node:mt,npm_config_node_gyp:ht,AMO_JWT_SECRET:yt,npm_package_version:bt,XPC_SERVICE_NAME:xt,SHLVL:$t,HOME:Ot,COLORFGBG:Pt,PERENNIAL_CMS_DIR:Rt,LC_TERMINAL_VERSION:wt,npm_config_save_exact:Et,PAUL_X10_SSH_IP_ADDRESS:vt,ITERM_SESSION_ID:Ft,npm_config_cache:kt,LESS:At,LOGNAME:St,npm_lifecycle_script:Ct,AFFILIATES_IP_QA:Tt,N_PRESERVE_NPM:Bt,npm_config_user_agent:Dt,AFFILIATES_DIR:Nt,JESSICA_FRONT_END_DIR:_t,MANAGE_NBA_DIR:qt,LC_TERMINAL:Ut,PERENNIAL_WWW_DIR:It,npm_config_init_author_name:Vt,npm_node_execpath:jt,npm_config_prefix:Lt,COLORTERM:zt,RELEASE_BUMP_VERSION:Zt};var B=require("fs"),$=require("fs/promises"),D=require("path"),E=[{description:"Path to changelog.",name:"changelogPath",type:"string"},{description:"Release date.",name:"date",type:"string"},{alias:"d",description:"Dry run.",name:"dryRun",type:"boolean"},{alias:"e",description:"Fail on error.",name:"failOnError",type:"boolean"},{description:"Path to directory of files to bump.",name:"filesPath",type:"string"},{description:"Directories to ignore.",name:"ignore",type:"string[]"},{alias:"h",description:"Log CLI usage text.",name:"help",type:"boolean"},{alias:"p",description:"Prefix release version with a 'v'.",name:"prefix",type:"boolean"},{alias:"q",description:"Quiet, no logs.",name:"quiet",type:"boolean"},{description:"Release version.",name:"release",type:"string"},{description:"Remote git repository URL.",name:"repository",type:"string"},{alias:"v",description:"Log Release Bump version.",name:"version",type:"boolean"}];function N(t,i){return t.filter(r=>!i.some(n=>r.includes(n)))}function _(t){if(typeof t=="string"){if(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()!@:%_+.~#?&/=]*)/.test(t))return t;if(/^[-a-zA-Z0-9()!@:%_+~#?&=]+\/[-a-zA-Z0-9()!@:%_+~#?&=]+$/.test(t))return`https://github.com/${t}`}else return typeof(t==null?void 0:t.url)>"u"?"":_(t.url.replace(/(^git\+|\.git$)/,""));return""}async function q(t,i){var b,u;let{date:r,isChangelog:n,prefix:o,quiet:l,release:a,repository:s}=i;if(!/^\d+\.\d+\.\d+$/.test(a))return t;let p=(u=(b=/\d+\.\d+\.\d+/.exec(a))==null?void 0:b[0])!=null?u:a;if(n===!1)return t.replace(/@([Ss]ince|[Vv]ersion)(:?\s+)unreleased/g,`@$1$2${p}`);let h=s.includes("bitbucket.org")?"bitbucket":"github",y=`${s}/${h==="bitbucket"?"commits":"releases"}/tag/${o?"v":""}${p}`,g=`## [${o?"v":""}${p}]`+(s!==""?`(${y})`:"")+(r?` - ${r}`:"");if(t.includes(g))return l!==!0&&console.info("changelog is already formatted"),t;let F=`(${s}/${h==="bitbucket"?"branches/":""}compare/HEAD..${o?"v":""}${p})`,P=`## [Unreleased]${s?F:""}

### `+["Added","Changed","Deprecated","Removed","Fixed","Security"].join(`

### `);return t.replace(/## \[Unreleased\](\(.*\))?/,g).replace(/### (Added|Changed|Deprecated|Removed|Fixed|Security)\n\n/g,"").replace(/### (Added|Changed|Deprecated|Removed|Fixed|Security)\n$/g,"").replace(/\n\n$/g,`
`).replace(g,P+`

`+g)}function U(t){return[`Usage
	$ release-bump <options>`,"Options"+t.reduce((i,r)=>{let n=r.alias?(r.name.length<6?"	":"")+`	-${r.alias}`:"		",o=r.alias?`	${r.description}`:(r.name.length<6?"	":"")+r.description;return i+`
	--${r.name}${n}${o}`},""),`Examples
	$ release-bump -pq --files=src`].join(`

`)}async function v(t){let{directoriesToIgnore:i,failOnError:r,filesPath:n,paths:o}=t;if(i.some(s=>n.includes(s)))return o!=null?o:[];let l=[];try{l=await(0,$.readdir)(n)}catch(s){if(s.code!=="ENOENT"){if(r)throw process.exitCode=1,s;console.warn(`could not read files in ${n}`)}l=[]}let a=await Promise.all(l.map(async s=>(await(0,$.stat)(`${n}/${s}`)).isDirectory()===!0?await v({directoriesToIgnore:i,failOnError:r,filesPath:`${n}/${s}`,paths:o}):(0,D.join)(`${n}/${s}`)));return[...new Set([...o,...a].flat(100))]}function I(t){return t!=null&&t.RELEASE_BUMP_VERSION?"v"+t.RELEASE_BUMP_VERSION:"no version found"}function V(t,i){return t.reduce((r,n,o)=>{let l={};if(n.indexOf("--")===0){let[a,s]=n.substr(2).split("="),c=i.find(p=>p.name===a);if(c)switch(c.type){case"boolean":l[a]=!0;break;case"string[]":l[a]=s==null?void 0:s.split(",");break;default:l[a]=s;break}}else if(n.indexOf("-")===0)[...n.substr(1)].forEach(a=>{let s=i.find(c=>c.alias===a);s&&(l[s.name]=!0)});else{let a=Object.keys(r),s=a[a.length-1],c=i.find(p=>p.name===s);c&&(r[s]===`$${o-1}`||typeof r[s]>"u")&&(l[s]=c.type==="string[]"?n.split(","):n)}return m(m({},r),l)},{})}function j(t){var l;let i={repository:"",version:"0.0.0"};try{i=JSON.parse((0,B.readFileSync)("package.json","utf8"))}catch(a){d.NODE_ENV!=="test"&&t.quiet!==!0&&console.warn("could not read package.json")}let r=[".git",".github","coverage","dist","node_modules","tests/fixtures"],n={changelogPath:"CHANGELOG.md",date:(l=new Date().toISOString().split("T"))==null?void 0:l[0],dryRun:!1,failOnError:!1,filesPath:".",ignore:r,prefix:!1,quiet:d.NODE_ENV==="test"||!1,release:i.version,repository:_(i.repository)};return m(m({},n),t)}var O=require("fs/promises");async function L(t){let{changelogPath:i,date:r,dryRun:n,failOnError:o,filesPath:l,ignore:a,prefix:s,quiet:c,release:p,repository:h}=j(t),y=d.NODE_ENV==="test"||n===!0,g=a,P=await v({directoriesToIgnore:g,failOnError:o,filesPath:l,paths:[i]}),b=N(P,g),u=[];return await Promise.all(b.map(async f=>{let R="";try{R=await(0,O.readFile)(f,"utf8")}catch(w){if(o)throw process.exitCode=1,w;c!==!0&&console.warn(`could not read ${f}`)}let k=await q(R,{date:r,isChangelog:i===f,prefix:s,quiet:c,release:p,repository:h});if(R!==k&&(u.push(f),y!==!0))try{await(0,O.writeFile)(f,k,"utf8")}catch(w){if(o)throw process.exitCode=1,w;c!==!0&&console.warn(`could not write ${f}`)}})),u.length>0&&c!==!0&&console.info((y?"would have ":"")+`bumped ${u.join(", ")}`),n?[]:u}(async function(){var o,l;let t=(l=(o=process.argv)==null?void 0:o.slice(2))!=null?l:[],a=V(t,E),{help:i,version:r}=a,n=T(a,["help","version"]);if(i===!0)return console.info(U(E));if(r===!0)return console.info(I(d));await L(n)})();
